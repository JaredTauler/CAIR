{% extends "base.html" %}
{% block head %}
<head>
    <link href="https://unpkg.com/tabulator-tables@5.0.7/dist/css/tabulator.min.css" rel="stylesheet">
 <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.0.7/dist/js/tabulator.min.js"></script>
</head>
{% endblock %}

{% block body %}
<body>
    <form id="ReportForm">
        <span>
            <input
                name = "DateStart"
                id="DateStart"
                title="Start Date"
                type="date"
                style="float:left;"
            >
            <input
                title="End Date"
                id="DateEnd"
                name="DateEnd"
                type="date"
                style="float:left;"
            >
        </span><br>

        <select
                title="Report Dropdown"
                id="ReportDropdown"
                name="ReportDropdown"
        >
            <option value="" disabled selected hidden>Report Name</option>
            <option value="name" >Student's Names</option>
            <option value="student" >Student's Tickets</option>
            <option value="user" >Your Tickets</option>

        </select><br>
        <input title="Student" type="text" id="ReportStudent" name="ReportStudent">
        <input type="button" title="Submit Button" id="ReportFetch" name="ReportFetch">
    </form>
    <table id="ReportTable" ></table>
</body>
{% endblock %}

{%  block script %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossOrigin="anonymous"></script>
    <script>
        var ReportTable = document.getElementById("ReportTable")
        var ReportTableTabulator = new Tabulator("#ReportTable", {
            autoColumns:true, //create columns from data field names
        });

        // On fetch button click,
        document.getElementById("ReportFetch").addEventListener("click", function(){
            let formData = new FormData(document.getElementById("ReportForm")) // Get form data
            // Post to server
            $.ajax({
                type: "POST",
                url: window.location.href,
                dataType: "json",
                processData: false,
                contentType: false,
                encode: true,
                data: formData,

            // On response data:
            }).done(function (data) {
                console.log(data)
                ReportTable.hidden = false
                var ReportTableTabulator = new Tabulator("#ReportTable", {
                    data: data,
                    autoColumns:true, //create columns from data field names
                });

            })


            // event.preventDefault();
            return false;
        })


     </script>
{% endblock %}
